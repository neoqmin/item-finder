# 🎤 iPhone 음성 인식 문제 해결 가이드

## 문제: 음성 캡처가 안 됨

iOS Safari는 보안상 **HTTPS 연결에서만** 음성 인식을 허용합니다.

## 해결 방법

### 1단계: HTTPS 인증서 생성

라즈베리파이에서:

```bash
cd item-finder
chmod +x generate-cert.sh
npm run generate-cert
```

이렇게 하면 `cert.pem`과 `key.pem` 파일이 생성됩니다.

### 2단계: HTTPS 서버 실행

```bash
npm start
```

다음과 같은 메시지가 표시됩니다:
```
HTTP 서버: http://[라즈베리파이IP]:3001
HTTPS 서버: https://[라즈베리파이IP]:3443
```

### 3단계: iPhone에서 HTTPS 접속

1. Safari에서 `https://192.168.1.100:3443` 접속 (IP는 실제 라즈베리파이 IP)
2. **보안 경고 화면**이 나타남
3. "고급" 또는 "자세히" 클릭
4. "계속 진행" 또는 "[IP주소] 방문" 클릭
5. 마이크 권한 요청이 나타나면 "허용" 클릭

### 4단계: 음성 검색 테스트

1. "음성 검색 시작" 버튼 클릭
2. 마이크 아이콘이 빨간색으로 변함
3. "잼 어디있어?" 말하기
4. 음성 응답 확인

## 보안 경고가 나타나는 이유

- 자체 서명 인증서는 공인 인증 기관이 발급한 것이 아님
- 집 내부 네트워크에서만 사용하므로 안전함
- "계속 진행"을 선택해도 괜찮음

## 여전히 작동하지 않는 경우

### 확인 사항:

1. **Safari 설정 확인**
   - iPhone 설정 → Safari → 마이크 → "허용" 또는 "묻기"

2. **Safari 사용 여부**
   - Chrome이 아닌 Safari 브라우저 사용 필요
   - iOS의 Chrome도 내부적으로 Safari 엔진 사용

3. **HTTPS 주소 확인**
   - `https://` 로 시작하는지 확인
   - 포트는 3443 사용

4. **방화벽 확인**
   - 라즈베리파이 방화벽에서 3443 포트 허용

5. **네트워크 확인**
   - iPhone과 라즈베리파이가 같은 Wi-Fi에 연결되어 있는지 확인

## 대안: HTTP에서 텍스트 검색 사용

HTTPS 설정이 어렵다면:
- HTTP (3001 포트)로 접속
- 음성 검색 대신 물건 이름을 직접 입력하는 검색창 추가 가능

## 추가 정보

- HTTPS는 음성 인식뿐만 아니라 카메라 접근에도 필요
- 한번 "계속 진행"을 선택하면 해당 IP는 신뢰됨
- 인증서는 1년간 유효 (만료 시 재생성 필요)

## 문제가 계속되면

1. 서버 재시작: `Ctrl+C` → `npm start`
2. iPhone Safari 캐시 삭제
3. iPhone 재부팅
