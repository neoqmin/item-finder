# 🔊 음성이 안 나올 때 체크리스트

## 즉시 확인할 것들

### 1️⃣ iPhone 하드웨어 설정
```
✅ 무음 모드 해제 (옆면 스위치가 주황색이면 무음)
✅ 볼륨 키로 소리 크기 확인
✅ 이어폰/블루투스 연결 확인 (연결되어 있으면 빼보기)
✅ 제어센터에서 볼륨 확인
```

### 2️⃣ Safari 설정
```
✅ Safari 브라우저 사용 (Chrome X)
✅ 사생활 보호 모드가 아님 확인
✅ iPhone 설정 → Safari → 고급 → JavaScript 켜짐 확인
```

### 3️⃣ 페이지 상태
```
✅ HTTPS 연결 확인 (https://)
✅ 페이지 새로고침 (F5 또는 당겨서 새로고침)
✅ Safari 캐시 삭제
```

## 단계별 테스트

### 단계 1: 음성 테스트 페이지 접속
```
https://[라즈베리파이IP]:3443/voice-test.html
```

이 페이지에서 5가지 테스트를 순서대로 해보세요:
1. 기본 음성 테스트 (Hello)
2. 한국어 음성 테스트 (안녕하세요)
3. 실제 메시지 테스트 (잼은 찬장에 있습니다)
4. 사용 가능한 음성 목록
5. 연속 재생 테스트

### 단계 2: 문제 진단

**소리가 전혀 안 들리면:**
```
→ 하드웨어 문제 가능성
  - iPhone 볼륨 확인
  - 무음 모드 확인
  - 다른 앱에서 소리 나는지 확인 (유튜브 등)
```

**"Hello"는 들리는데 한국어가 안 들리면:**
```
→ 한국어 음성 엔진 문제
  - iPhone 설정 → 손쉬운 사용 → 음성 콘텐츠 → 음성
  - 한국어 음성 다운로드 확인
```

**테스트는 되는데 앱에서 안 나오면:**
```
→ 타이밍 문제
  - 음성 검색 후 팝업이 뜨는지 확인
  - "다시 듣기" 버튼 눌러보기
  - 디버그 페이지에서 로그 확인
```

## 흔한 문제들

### 문제 1: 무음 모드
**증상:** 모든 테스트에서 소리 안 남
**해결:** iPhone 옆면 스위치 확인, 주황색이 보이면 안 됨

### 문제 2: 이어폰 연결됨
**증상:** 스피커에서 소리 안 나지만 이어폰에서는 들림
**해결:** 블루투스/유선 이어폰 해제

### 문제 3: 볼륨 0
**증상:** 화면에는 재생되는데 소리 안 들림
**해결:** 볼륨 버튼으로 소리 키우기

### 문제 4: iOS Safari 버그
**증상:** 첫 번째는 안 나오고 두 번째부터 나옴
**해결:** 이미 코드에서 자동 재시도 처리됨, 그래도 안 되면 페이지 새로고침

### 문제 5: 한국어 음성 없음
**증상:** 영어는 되는데 한국어가 로봇 음성이거나 안 나옴
**해결:** 
```
iPhone 설정 앱
→ 손쉬운 사용
→ 음성 콘텐츠
→ 음성
→ 한국어 추가 (Yuna, Sora 등)
```

## 디버깅 로그 해석

### 정상 작동 시:
```
🔊 음성 출력 시도: "잼은 찬장에 있습니다."
📢 speak() 호출 (볼륨: 1)
▶️ 음성 출력 시작
⏹️ 음성 출력 완료
```

### 문제 있을 시:
```
❌ 음성 출력 오류: not-allowed
→ 브라우저 권한 문제, 페이지 새로고침

❌ 음성 출력 오류: interrupted
→ iOS 버그, 자동 재시도됨

⚠️ speaking 상태가 아님, 재시도
→ 첫 실행 실패, 자동 재시도
```

## 최종 해결책

### 방법 1: 페이지 새로고침
```
Safari → 새로고침 (당겨서 새로고침)
→ 다시 음성 검색 시도
```

### 방법 2: Safari 완전히 종료
```
1. 홈 버튼/제스처로 Safari 종료
2. 앱 스위처에서 Safari 완전히 닫기
3. Safari 다시 열기
4. 페이지 재접속
```

### 방법 3: iPhone 재부팅
```
1. iPhone 전원 끄기
2. 10초 대기
3. 전원 켜기
4. Safari 열고 재접속
```

### 방법 4: 서버 재시작
```
라즈베리파이에서:
Ctrl+C (서버 중지)
npm start (서버 재시작)
iPhone에서 페이지 새로고침
```

## 확인용 체크리스트

음성이 나오지 않는다면 아래 항목을 하나씩 체크하세요:

- [ ] iPhone 무음 모드 해제됨
- [ ] 볼륨이 50% 이상
- [ ] 이어폰/블루투스 연결 안 됨
- [ ] Safari 브라우저 사용 중
- [ ] https:// 주소 사용 중
- [ ] 음성 테스트 페이지에서 "Hello" 들림
- [ ] 음성 테스트 페이지에서 "안녕하세요" 들림
- [ ] 팝업 모달이 정상적으로 뜸
- [ ] 콘솔에 "음성 출력 시작" 로그 보임

모두 체크했는데도 안 된다면:
1. 다른 iPhone에서 테스트
2. 유튜브 등 다른 앱에서 소리 나는지 확인
3. iPhone 설정 → 손쉬운 사용 → 음성 콘텐츠 확인

## 빠른 테스트 방법

가장 빠른 확인 방법:
```
1. https://[IP]:3443/voice-test.html 접속
2. "1️⃣ 기본 음성 테스트" 버튼 클릭
3. "Hello" 소리 들리는지 확인

들린다 → 앱 문제, 디버그 페이지 사용
안 들린다 → 하드웨어 문제, 위 체크리스트 확인
```
